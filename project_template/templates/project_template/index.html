<html>
    <head>
        <link rel="stylesheet" href="/static/bootstrap.min.css">
        <link rel="stylesheet" href="/static/main.css">
        <script src="//d3js.org/d3.v3.min.js"></script>
    </head>
    
    <body>
        <!-- TODO: Please change lines 10 and 11 according to your actual project name and student names-->
        <div class="topcorner">
            <p>Power Of Speech</p>
            <p>Rebecca Mozdy (rlm393), Daniel Rong (ddr42), Jacqueline Viola (jlv78), Batya Zamansky (bz82)</p>
        </div>
        
        <form class="form-inline global-search" method='GET'>
            <h1 style="font-size: 55px; font-family:Futura; color: #4285F4">
                C
                <font color=#EA4335>S</font>
                <font color=#FBBC05>4</font>
                3
                <font color=#34A853>0</font>
                <font color=#EA4335>0</font>
            </h1>
            
            <br><br>
            
            <div class="form-group">
                <input id="input" type="text" name="search" class="form-control" placeholder="Your Input">
                <!-- JACKIE'S NEW CODE -->
                <br>
                <input type="radio" name="search_option" value="candidate"> Search by Candidate
                <input type="radio" name="search_option" value="term"> Search by Term
            </div>
            <button type="submit" class="btn btn-info"> Go! </button>
        </form>
        
        <div class="form-inline global-search">
            <h4>Output</h4><br>
            {% comment %}
            {{output}}
            {% endcomment %}
            
            <!-- PAGINATOR STUFF -->
            <!-- {% for line in output %}
                {{line}}<br>
            {% endfor %} -->

            <h5>Searched: {{searched}}</h5>
            <br/>
            {% for value in plot %}
                {% for part in value %}
                {{part}}
                {% endfor %}
                <br/>
            {% endfor %}
            

            {% comment %}
            {% for key,val in output.items %}
                {{key}} {{val}}<br>
            {% endfor %}
            {% endcomment %}
            
            

            <h3 id="fill_me"></h3>

            <!-- REMEMBER TO UNCOMMENT THIS IF NEED PAGINATOR -->
            <!-- <div class="pagination">
                <span class="step-links">
                    {% comment %}
                    {% if output.has_previous %}
                    <a href= "{{magic_url}}&page={{ output.previous_page_number }}">previous</a>
                    {% endif %} -->
                    
                    <!-- Showing the page numbers in Html Page -->
                    <!-- <span class="current">
                    Page _{{ output.number }}_ of _{{ output.paginator.num_pages }}_
                    </span>
                    
                    {% if output.has_next %}
                    <a href= "{{magic_url}}&page={{ output.next_page_number }}">next</a>
                    {% endif %}
                    {% endcomment %}
                </span>
            </div> -->
        </div>
        <script type="text/javascript">
            var candidate_names = {{candidate_names|safe}}; // array of candidate names
            var mentions_by_candidate = {{mentions_by_candidate}}; // array of ints, which are the number of times each candidate mentions the query
            var mentions_by_debate = {{mentions_by_debate}}; // array of ints, which are the number of times each query is mentioned in each debate
            var interactions = {{interactions}};

            // MAKE BAR GRAPH 
            /* x_values are labels for bar graphs 
                bar plot help from https://bl.ocks.org/mbostock/3885304
            */
            function makeBarGraph(x_values, y_values) {
                // make json array
                var data = [];
                for (var i = 0; i < x_values.length; i++) {
                    data.push({'x':x_values[i],'y':y_values[i]});
                }

                var formatCount = d3.format(",.0f");

                var margin = {top: 10, right: 30, bottom: 30, left: 30},
                    width = 1000 - margin.left - margin.right,
                    height = 500 - margin.top - margin.bottom;

                var y = d3.scale.linear()
                    .domain([0, d3.max(y_values)])
                    .range([height, 0]);

                var chart = d3.select("body").append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
            
                var barWidth = (width - margin.left)/ x_values.length;

                var bar = chart.selectAll("g")
                    .data(data)
                    .enter().append("g")
                    .attr("class","bar")
                    .attr("transform", function(d, i) { return "translate(" + i * barWidth + ",-20)"; });

                bar.append("rect")
                    .attr("y", function(d) { return y(d.y); })
                    .attr("height", function(d) { return height - y(d.y); })
                    .attr("width", barWidth - 1);

                bar.append("text")
                    //.attr("x", barWidth / 2)
                    .attr("y", function(d) { return y(d.y) - 30; })
                    .attr("dy", ".75em")
                    .attr("fill",'red')
                    .text(function(d) { return d.x; });

            }

            // query mentions by candidate
            makeBarGraph(candidate_names, mentions_by_candidate);
            


        </script>
    </body>
</html>